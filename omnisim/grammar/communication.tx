import datatype
import msg

CommunicationModel:
    (imports*=Import)?
    communications*=Communication
;

Communication:
    'Communication' name=ID
    (
        'endpoints'
            endpoints*=Endpoint
        'end'

        'messages'
            msgs*=Message
        'end'
    )#
    'end'
;

Endpoint: Publisher | Subscriber;

Publisher:
    'publisher'
    (
        ('topic:' topic=STRING)
        ('msg:' msg=[PubSubMessage:FQN|^msgs])?
        ('namespace:' namespace=STRING)?
    )#
    'end'
;

Subscriber:
    'subscriber'
    (
        ('topic:' topic=STRING)
        ('msg:' msg=[PubSubMessage:FQN|^msgs])?
        ('namespace:' namespace=STRING)?
    )#
    'end'
;